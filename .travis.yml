language: android

jdk: oraclejdk8

android:
 components:
 - tools
 - platform-tools
 - build-tools-27.0.3
 - android-27
 - extra-google-m2repository
 - extra-android-m2repository

before_script:
- chmod 755 ./gradlew
- chmod 755 ./build-apk.sh

script:
- ./gradlew testDebugUnittest
- ./build-apk.sh

deploy:
  provider: releases
  api_key:
    secure: "a07e44b3c3e0cc612934cb8e36712ed10b300e74"
  file: "./build/apk/juxebox.apk"
  file_glob: true
  skip_cleannup : true
  on:
    repo: JulienHivert/ptut_Ol-d_Tam
    branch: master
